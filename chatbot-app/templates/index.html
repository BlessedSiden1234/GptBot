<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chat with B.S Bot</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
  <div class="chat-container">
    <h2>🤖 Chat with B.S Bot</h2>
    <div id="chat-box" class="chat-box"></div>
    <div class="input-area">
      <input id="user-input" placeholder="Type your question..." />
      <button id="send-btn">Send</button>
    </div>
  </div>

  <!-- FAQ Section -->
  <div class="faq-section">
    <h3>❓ Frequently Asked Questions</h3>
    <ul>
      <li>Who built you?</li>
      <li>Tell me about Blessed Siden</li>
      <li>What are Blessed Siden’s educational qualifications?</li>
      <li>What technical skills does Blessed Siden possess?</li>
      <li>What cloud technologies is Blessed Siden familiar with?</li>
      <li>What is Blessed Siden’s expertise in machine learning and AI?</li>
      <li>What motivates Blessed Siden in his work?</li>
      <li>How does Blessed Siden use cloud technologies in his projects?</li>
      <li>How does Blessed Siden ensure continuous learning in tech?</li>
      <li>What are Blessed Siden’s future career aspirations?</li>
      <li>Has Blessed Siden contributed to open-source projects?</li>
      <li>What leadership roles has Blessed Siden taken in projects?</li>
      <li>How does Blessed Siden handle teamwork and collaboration?</li>
      <li>Does Blessed Siden have experience in agile methodologies?</li>
      <li>How does Blessed Siden integrate safety with project innovation?</li>
      <li>What impact does Blessed Siden want to make in engineering and tech?</li>

    </ul>
  </div>

  <script>
    let sender = localStorage.getItem('rasa_sender_id');
    if (!sender) {
      sender = 'user-' + Math.random().toString(36).substring(2, 12);
      localStorage.setItem('rasa_sender_id', sender);
    }

    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');

    function addMessage(text, cls, animated = false) {
      const el = document.createElement('div');
      el.className = cls;

      if (animated) {
        let i = 0;
        const interval = setInterval(() => {
          el.innerHTML = text.substring(0, i++) + "<span class='cursor'>|</span>";
          if (i > text.length) {
            clearInterval(interval);
            el.innerHTML = text; // remove cursor
          }
          chatBox.scrollTop = chatBox.scrollHeight;
        }, 40);
      } else {
        el.innerHTML = text;
      }

      chatBox.appendChild(el);
      chatBox.scrollTop = chatBox.scrollHeight;
      return el;
    }

    async function sendMessage(msg = null) {
      const message = msg || userInput.value.trim();
      if (!message) return;

      addMessage(message, "user-message");
      userInput.value = '';

      const thinkingEl = addMessage("🤖 B.S Bot is thinking...", "bot-message thinking");

      try {
        const resp = await fetch('/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message, sender })
        });
        const data = await resp.json();

        if (thinkingEl && thinkingEl.parentNode) thinkingEl.remove();

        addMessage(data.response, "bot-message", true);
      } catch (err) {
        if (thinkingEl && thinkingEl.parentNode) thinkingEl.remove();
        addMessage("⚠️ Error: could not reach the server.", "bot-message");
      }
    }

    sendBtn.addEventListener('click', () => sendMessage());
    userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });

    // FAQ click functionality
    document.querySelectorAll('.faq-section li').forEach(li => {
      li.addEventListener('click', () => {
        const question = li.textContent;
        sendMessage(question);

        // Scroll chat container to bottom smoothly
        const chatContainer = document.querySelector('.chat-container');
        chatContainer.scrollIntoView({ behavior: 'smooth', block: 'end' });
      });
    });

    // Initial welcome message
    window.addEventListener('load', () => {
      addMessage("Hello! 👋 I’m B.S Bot. Ask me anything about Blessed Siden.", "bot-message", true);
    });
  </script>
</body>

</html>